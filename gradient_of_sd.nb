(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    215523,       5767]
NotebookOptionsPosition[    211965,       5701]
NotebookOutlinePosition[    212397,       5718]
CellTagsIndexPosition[    212354,       5715]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"sigmaw", "=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["w", "i"], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "i"], "-", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["w", "i"], 
               SubscriptBox["x", "i"]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "/", 
            RowBox[{"Sum", "[", 
             RowBox[{
              SubscriptBox["w", "i"], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], ")"}], 
         "^", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "/", 
     RowBox[{"Sum", "[", 
      RowBox[{
       SubscriptBox["w", "i"], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.894697362441667*^9, {3.8946997006560783`*^9, 3.894699777458551*^9}, {
   3.894699845627779*^9, 3.894699878859105*^9}, 3.900531860958293*^9, {
   3.930133569092677*^9, 3.930133625928151*^9}, {3.930133659116802*^9, 
   3.930133852446802*^9}, {3.930133884522327*^9, 3.9301339291793633`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"10bd1a91-960a-40a6-9d1f-f74699196983"],

Cell[BoxData[
 SqrtBox[
  FractionBox[
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], "n"], 
    RowBox[{
     SubscriptBox["w", "i"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["x", "i"], "-", 
        FractionBox[
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"i", "=", "1"}], "n"], 
          RowBox[{
           SubscriptBox["w", "i"], " ", 
           SubscriptBox["x", "i"]}]}], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"i", "=", "1"}], "n"], 
          SubscriptBox["w", "i"]}]]}], ")"}], "2"]}]}], 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], "n"], 
    SubscriptBox["w", "i"]}]]]], "Output",
 CellChangeTimes->{
  3.894697366168857*^9, {3.8946997223574963`*^9, 3.894699778657021*^9}, 
   3.8946999625742598`*^9, 3.895993799956419*^9, 3.8994515973513203`*^9, 
   3.90053186790968*^9, {3.93013380495862*^9, 3.930133820270396*^9}, 
   3.930133853048052*^9, 3.930133887781876*^9, 3.930133929854704*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"7ebd41dd-def4-4a42-ac62-3352b74b7db2"]
}, Open  ]],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{{3.89469737228968*^9, 3.8946974050493937`*^9}, {
  3.894697452281707*^9, 3.894697463464911*^9}, {3.8946996050849037`*^9, 
  3.894699653331574*^9}, {3.894699800117127*^9, 3.894699802836349*^9}, {
  3.894699870722103*^9, 3.894699871836982*^9}, {3.930133863124568*^9, 
  3.930133866575213*^9}},ExpressionUUID->"a9fcef6d-53b6-48f4-a0c6-\
58bf5bdb85eb"],

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{"sigmaw", ",", "x_i"}], "]"}]], "Input",
 CellChangeTimes->{{3.93013397262551*^9, 
  3.9301340055336123`*^9}},ExpressionUUID->"e667996f-aaea-4a41-b234-\
bc23bdb4ff43"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.930133868638752*^9, 
  3.930133871612277*^9}},ExpressionUUID->"cad1be5d-7595-4a89-b0ae-\
3529288684fb"],

Cell[CellGroupData[{

Cell[BoxData[
 TemplateBox[{
   RowBox[{"(", "sigmaw", ")"}], 
   RowBox[{"{", 
     SubscriptBox["x", "i"], "}"}]},
  "Grad"]], "Input",
 CellChangeTimes->{{3.894697439234045*^9, 3.894697467840798*^9}, {
  3.8946996644525623`*^9, 3.8946996698038263`*^9}, {3.894700175469775*^9, 
  3.8947001804082613`*^9}, {3.894700634706514*^9, 3.894700665084495*^9}, {
  3.93013389193034*^9, 3.930133895409677*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"30422168-0832-498a-a1ca-fe9233db02cb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "1"}], "n"], 
      RowBox[{
       SubscriptBox["w", "i"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["x", "i"], "-", 
          FractionBox[
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"i", "=", "1"}], "n"], 
            RowBox[{
             SubscriptBox["w", "i"], " ", 
             SubscriptBox["x", "i"]}]}], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"i", "=", "1"}], "n"], 
            SubscriptBox["w", "i"]}]]}], ")"}], "2"]}]}]}]], 
   SqrtBox[
    FractionBox[
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "1"}], "n"], 
      RowBox[{
       SubscriptBox["w", "i"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["x", "i"], "-", 
          FractionBox[
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"i", "=", "1"}], "n"], 
            RowBox[{
             SubscriptBox["w", "i"], " ", 
             SubscriptBox["x", "i"]}]}], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"i", "=", "1"}], "n"], 
            SubscriptBox["w", "i"]}]]}], ")"}], "2"]}]}], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "1"}], "n"], 
      SubscriptBox["w", "i"]}]]], " ", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{
      RowBox[{"K", "[", "2", "]"}], "=", "1"}], "n"], 
    RowBox[{
     SubscriptBox["w", 
      RowBox[{"K", "[", "2", "]"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        TemplateBox[{
          RowBox[{"i", ",", 
            RowBox[{"K", "[", "2", "]"}]}]},
         "KroneckerDeltaSeq"], " ", 
        SubscriptBox["x", 
         RowBox[{"K", "[", "2", "]"}]]}], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         SubscriptBox["x", 
          RowBox[{"K", "[", "2", "]"}]], " ", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{
            RowBox[{"K", "[", "4", "]"}], "=", "1"}], "n"], 
          RowBox[{
           TemplateBox[{
             RowBox[{"i", ",", 
               RowBox[{"K", "[", "4", "]"}]}]},
            "KroneckerDeltaSeq"], " ", 
           SubscriptBox["w", 
            RowBox[{"K", "[", "4", "]"}]]}]}]}], 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{
           RowBox[{"K", "[", "3", "]"}], "=", "1"}], "n"], 
         SubscriptBox["w", 
          RowBox[{"K", "[", "3", "]"}]]}]], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         TemplateBox[{
           RowBox[{"i", ",", 
             RowBox[{"K", "[", "2", "]"}]}]},
          "KroneckerDeltaSeq"], " ", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{
            RowBox[{"K", "[", "4", "]"}], "=", "1"}], "n"], 
          RowBox[{
           SubscriptBox["w", 
            RowBox[{"K", "[", "4", "]"}]], " ", 
           SubscriptBox["x", 
            RowBox[{"K", "[", "4", "]"}]]}]}]}], 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{
           RowBox[{"K", "[", "3", "]"}], "=", "1"}], "n"], 
         SubscriptBox["w", 
          RowBox[{"K", "[", "3", "]"}]]}]], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{
             RowBox[{"K", "[", "4", "]"}], "=", "1"}], "n"], 
           RowBox[{
            TemplateBox[{
              RowBox[{"i", ",", 
                RowBox[{"K", "[", "4", "]"}]}]},
             "KroneckerDeltaSeq"], " ", 
            SubscriptBox["w", 
             RowBox[{"K", "[", "4", "]"}]]}]}], ")"}], " ", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{
            RowBox[{"K", "[", "4", "]"}], "=", "1"}], "n"], 
          RowBox[{
           SubscriptBox["w", 
            RowBox[{"K", "[", "4", "]"}]], " ", 
           SubscriptBox["x", 
            RowBox[{"K", "[", "4", "]"}]]}]}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{
             RowBox[{"K", "[", "3", "]"}], "=", "1"}], "n"], 
           SubscriptBox["w", 
            RowBox[{"K", "[", "3", "]"}]]}], ")"}], "2"]]}], ")"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.894701180374997*^9, 3.895993803504567*^9, 
  3.899451603975774*^9, 3.900531871636611*^9, 3.9301338972678547`*^9, 
  3.930133932657922*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"9859968c-cbe8-4e02-aa37-4ac111b4ee2a"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.894700855743903*^9, 3.894700861182472*^9}, {
  3.894701190296156*^9, 
  3.8947011936936827`*^9}},ExpressionUUID->"b3958018-5d9c-4e82-9b8f-\
8e94f7b87bf6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"each_term", " ", "=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["qf", "k"], "[", "q", "]"}], "/", "r"}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", "qr", "]"}], "/", 
       RowBox[{"(", "qr", ")"}]}], ")"}], " ", "-", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sin", "[", "qr", "]"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q", "^", "2"}], 
         RowBox[{"r", "^", "2"}]}], ")"}]}], ")"}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["x", "i"], "-", 
     SubscriptBox["x", "j"]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.894700865970922*^9, 3.89470102029247*^9}, {
  3.894701068483344*^9, 3.894701097915742*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"ed25bad1-e509-4011-b788-098495d935c0"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"Cos", "[", "qr", "]"}], "qr"], "-", 
     FractionBox[
      RowBox[{"Sin", "[", "qr", "]"}], 
      RowBox[{
       SuperscriptBox["q", "2"], " ", 
       SuperscriptBox["r", "2"]}]]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["x", "i"], "-", 
     SubscriptBox["x", "j"]}], ")"}], " ", 
   RowBox[{
    SubscriptBox["qf", "k"], "[", "q", "]"}]}], "r"]], "Output",
 CellChangeTimes->{{3.89470091029817*^9, 3.894700939643733*^9}, {
   3.8947009954847*^9, 3.894701020806177*^9}, {3.894701073174841*^9, 
   3.894701098476591*^9}, 3.89599380585858*^9, 3.899451609093687*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"30868f64-c526-4ffb-8c37-00b9ec6966c3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 TemplateBox[{
   TemplateBox[{
     RowBox[{"(", 
       RowBox[{"S", "[", "q", "]"}], ")"}], 
     RowBox[{"{", 
       SubscriptBox["x", "i"], "}"}]}, "Grad"], 
   RowBox[{"{", 
     SubscriptBox["x", "i"], "}"}]},
  "Grad"]], "Input",
 CellChangeTimes->{{3.894697439234045*^9, 3.894697467840798*^9}, {
  3.8946996644525623`*^9, 3.8946996698038263`*^9}, {3.894700175469775*^9, 
  3.8947001804082613`*^9}, {3.894700634706514*^9, 3.894700665084495*^9}, {
  3.89599372392239*^9, 3.895993727904005*^9}, {3.89599460720463*^9, 
  3.895994658350973*^9}, {3.895994801838077*^9, 3.895994862675686*^9}, {
  3.895994899453532*^9, 3.89599495899354*^9}, {3.895995014003901*^9, 
  3.895995036976199*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"2b2c4d15-3013-42be-9f95-1874cf63dbb6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"k", "=", "1"}], 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["x", "i"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              SubscriptBox["x", "i"], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
               RowBox[{"3", "/", "2"}]]]}], "+", 
            FractionBox[
             SubscriptBox["x", "j"], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
              RowBox[{"3", "/", "2"}]]]}], ")"}]}], "-", 
         RowBox[{
          SubscriptBox["x", "j"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              SubscriptBox["x", "i"], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
               RowBox[{"3", "/", "2"}]]]}], "+", 
            FractionBox[
             SubscriptBox["x", "j"], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
              RowBox[{"3", "/", "2"}]]]}], ")"}]}], "+", 
         FractionBox["1", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "i"], "-", 
               SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["z", "i"], "-", 
               SubscriptBox["z", "j"]}], ")"}], "2"]}]]]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"Sin", "[", 
            RowBox[{"q", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["y", "i"], "-", 
                  SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["z", "i"], "-", 
                  SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
           RowBox[{
            SuperscriptBox["q", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["y", "i"], "-", 
                 SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["z", "i"], "-", 
                 SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
         FractionBox[
          RowBox[{"Cos", "[", 
           RowBox[{"q", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["y", "i"], "-", 
                 SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["z", "i"], "-", 
                 SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
          RowBox[{"q", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["x", "i"], "-", 
                SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["y", "i"], "-", 
                SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["z", "i"], "-", 
                SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["f", "k"], "[", "q", "]"}]}], "+", 
      RowBox[{"q", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          SubscriptBox["x", "i"], 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "i"], "-", 
               SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["z", "i"], "-", 
               SubscriptBox["z", "j"]}], ")"}], "2"]}]]], "-", 
         FractionBox[
          SubscriptBox["x", "j"], 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "i"], "-", 
               SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["z", "i"], "-", 
               SubscriptBox["z", "j"]}], ")"}], "2"]}]]]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"q", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"2", " ", 
                 SubscriptBox["x", "i"]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], "2"]]}], 
              "+", 
              FractionBox[
               RowBox[{"2", " ", 
                SubscriptBox["x", "j"]}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], "2"]]}], 
             ")"}]}], 
           SuperscriptBox["q", "2"]]}], "+", 
         RowBox[{
          FractionBox["1", "q"], 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"q", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["y", "i"], "-", 
                  SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["z", "i"], "-", 
                  SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               SubscriptBox["x", "i"], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
                RowBox[{"3", "/", "2"}]]]}], "+", 
             FractionBox[
              SubscriptBox["x", "j"], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
               RowBox[{"3", "/", "2"}]]]}], ")"}]}]}], "-", 
         FractionBox[
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"q", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["y", "i"], "-", 
                  SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["z", "i"], "-", 
                  SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              SubscriptBox["x", "i"], 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}]]], "-", 
             FractionBox[
              SubscriptBox["x", "j"], 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}]]]}], ")"}]}], 
          RowBox[{"q", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["x", "i"], "-", 
                SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["y", "i"], "-", 
                SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["z", "i"], "-", 
                SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]], "-", 
         FractionBox[
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"q", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["y", "i"], "-", 
                  SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["z", "i"], "-", 
                  SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              SubscriptBox["x", "i"], 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}]]], "-", 
             FractionBox[
              SubscriptBox["x", "j"], 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}]]]}], ")"}]}], 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "i"], "-", 
               SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["z", "i"], "-", 
               SubscriptBox["z", "j"]}], ")"}], "2"]}]]]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["f", "k"], "[", "q", "]"}]}]}], ")"}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.895995038436092*^9, 3.899451611692815*^9, 
  3.900531876560103*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"e06141b4-1d19-4a6a-9391-7061a7ee98be"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 TemplateBox[{
   TemplateBox[{
     RowBox[{"(", 
       RowBox[{"S", "[", "q", "]"}], ")"}], 
     RowBox[{"{", 
       SubscriptBox["x", "j"], "}"}]}, "Grad"], 
   RowBox[{"{", 
     SubscriptBox["x", "i"], "}"}]},
  "Grad"]], "Input",
 CellChangeTimes->{{3.8994515474962*^9, 3.8994515481355247`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"d85fbf89-104c-4dd0-8828-81c2aee0a145"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"k", "=", "1"}], 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SubscriptBox["x", "i"]}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              SubscriptBox["x", "i"], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
               RowBox[{"3", "/", "2"}]]]}], "+", 
            FractionBox[
             SubscriptBox["x", "j"], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
              RowBox[{"3", "/", "2"}]]]}], ")"}]}], "+", 
         RowBox[{
          SubscriptBox["x", "j"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              SubscriptBox["x", "i"], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
               RowBox[{"3", "/", "2"}]]]}], "+", 
            FractionBox[
             SubscriptBox["x", "j"], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
              RowBox[{"3", "/", "2"}]]]}], ")"}]}], "-", 
         FractionBox["1", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "i"], "-", 
               SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["z", "i"], "-", 
               SubscriptBox["z", "j"]}], ")"}], "2"]}]]]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"Sin", "[", 
            RowBox[{"q", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["y", "i"], "-", 
                  SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["z", "i"], "-", 
                  SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
           RowBox[{
            SuperscriptBox["q", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["y", "i"], "-", 
                 SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["z", "i"], "-", 
                 SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
         FractionBox[
          RowBox[{"Cos", "[", 
           RowBox[{"q", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["y", "i"], "-", 
                 SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["z", "i"], "-", 
                 SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
          RowBox[{"q", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["x", "i"], "-", 
                SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["y", "i"], "-", 
                SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["z", "i"], "-", 
                SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["f", "k"], "[", "q", "]"}]}], "+", 
      RowBox[{"q", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           SubscriptBox["x", "i"], 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["x", "i"], "-", 
                SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["y", "i"], "-", 
                SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["z", "i"], "-", 
                SubscriptBox["z", "j"]}], ")"}], "2"]}]]]}], "+", 
         FractionBox[
          SubscriptBox["x", "j"], 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "i"], "-", 
               SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["z", "i"], "-", 
               SubscriptBox["z", "j"]}], ")"}], "2"]}]]]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"q", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"2", " ", 
                 SubscriptBox["x", "i"]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], "2"]]}], 
              "+", 
              FractionBox[
               RowBox[{"2", " ", 
                SubscriptBox["x", "j"]}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], "2"]]}], 
             ")"}]}], 
           SuperscriptBox["q", "2"]]}], "+", 
         RowBox[{
          FractionBox["1", "q"], 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"q", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["y", "i"], "-", 
                  SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["z", "i"], "-", 
                  SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               SubscriptBox["x", "i"], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
                RowBox[{"3", "/", "2"}]]]}], "+", 
             FractionBox[
              SubscriptBox["x", "j"], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
               RowBox[{"3", "/", "2"}]]]}], ")"}]}]}], "-", 
         FractionBox[
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"q", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["y", "i"], "-", 
                  SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["z", "i"], "-", 
                  SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              SubscriptBox["x", "i"], 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}]]], "-", 
             FractionBox[
              SubscriptBox["x", "j"], 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}]]]}], ")"}]}], 
          RowBox[{"q", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["x", "i"], "-", 
                SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["y", "i"], "-", 
                SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["z", "i"], "-", 
                SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]], "-", 
         FractionBox[
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"q", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["y", "i"], "-", 
                  SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["z", "i"], "-", 
                  SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              SubscriptBox["x", "i"], 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}]]], "-", 
             FractionBox[
              SubscriptBox["x", "j"], 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}]]]}], ")"}]}], 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "i"], "-", 
               SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["z", "i"], "-", 
               SubscriptBox["z", "j"]}], ")"}], "2"]}]]]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["f", "k"], "[", "q", "]"}]}]}], ")"}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.899451549057663*^9, 3.899451624835658*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"73d54b19-f9f7-4119-822e-22aecbdf4f25"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"F", "[", "q", "]"}], "=", 
   RowBox[{
    SubscriptBox["f", "k"], 
    RowBox[{"Sinc", "[", 
     RowBox[{"q", "*", 
      SubscriptBox["r", "k"]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.900531976774132*^9, 3.900532053894186*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"bae667fa-1b80-4767-a411-556b92e3d09f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sinc", "[", 
   RowBox[{"q", " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["x", "i"], "-", 
         SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["y", "i"], "-", 
         SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["z", "i"], "-", 
         SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
  SubscriptBox["f", "k"]}]], "Output",
 CellChangeTimes->{
  3.9005319780917177`*^9, 3.900532008237013*^9, {3.900532051680216*^9, 
   3.900532054353015*^9}},
 CellLabel->"Out[14]=",ExpressionUUID->"9355dbc0-08f6-41f2-b513-50b4a91eb0d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 TemplateBox[{
   RowBox[{"(", 
     RowBox[{"F", "[", "q", "]"}], ")"}], 
   RowBox[{"{", 
     SubscriptBox["x", "i"], "}"}]},
  "Grad"]], "Input",
 CellChangeTimes->{{3.9005320717019167`*^9, 3.90053207186238*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"7d163013-522e-47ed-99e4-22a7066e7f79"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"q", " ", 
    SubscriptBox["f", "k"], " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["x", "i"], "-", 
      SubscriptBox["x", "j"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Sin", "[", 
         RowBox[{"q", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "i"], "-", 
               SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["z", "i"], "-", 
               SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
        RowBox[{
         SuperscriptBox["q", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["x", "i"], "-", 
              SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["y", "i"], "-", 
              SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["z", "i"], "-", 
              SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
      FractionBox[
       RowBox[{"Cos", "[", 
        RowBox[{"q", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["x", "i"], "-", 
              SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["y", "i"], "-", 
              SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["z", "i"], "-", 
              SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
       RowBox[{"q", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["x", "i"], "-", 
             SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["y", "i"], "-", 
             SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["z", "i"], "-", 
             SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}]}], 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["x", "i"], "-", 
        SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["y", "i"], "-", 
        SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["z", "i"], "-", 
        SubscriptBox["z", "j"]}], ")"}], "2"]}]]], "}"}]], "Output",
 CellChangeTimes->{3.9005320729408407`*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"1876a1e0-f81f-4c4b-882d-94723fb2a68d"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.899456152675438*^9, 
  3.899456154536787*^9}},ExpressionUUID->"554c50a0-51da-4790-a3b8-\
13fbce05101f"],

Cell[CellGroupData[{

Cell[BoxData[
 TemplateBox[{
   TemplateBox[{
     RowBox[{"(", 
       RowBox[{"F", "[", "q", "]"}], ")"}], 
     RowBox[{"{", 
       SubscriptBox["x", "i"], "}"}]}, "Grad"], 
   RowBox[{"{", 
     SubscriptBox["x", "i"], "}"}]},
  "Grad"]], "Input",
 CellChangeTimes->{{3.900532109833941*^9, 3.900532113560535*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"395ac65b-371e-45be-a70b-e48def08f163"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"q", " ", 
       SubscriptBox["f", "k"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["x", "i"], "-", 
          SubscriptBox["x", "j"]}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"Sin", "[", 
            RowBox[{"q", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["y", "i"], "-", 
                  SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["z", "i"], "-", 
                  SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
           RowBox[{
            SuperscriptBox["q", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["y", "i"], "-", 
                 SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["z", "i"], "-", 
                 SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
         FractionBox[
          RowBox[{"Cos", "[", 
           RowBox[{"q", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["y", "i"], "-", 
                 SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["z", "i"], "-", 
                 SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
          RowBox[{"q", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["x", "i"], "-", 
                SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["y", "i"], "-", 
                SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["z", "i"], "-", 
                SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["x", "i"], "-", 
            SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["y", "i"], "-", 
            SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["z", "i"], "-", 
            SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q", " ", 
       SubscriptBox["f", "k"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["x", "i"], "-", 
         SubscriptBox["x", "j"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"q", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["y", "i"], "-", 
                  SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["z", "i"], "-", 
                  SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["x", "i"], "-", 
             SubscriptBox["x", "j"]}], ")"}]}], 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["y", "i"], "-", 
                 SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["z", "i"], "-", 
                 SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], "2"]}]], "-", 
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"q", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["y", "i"], "-", 
                  SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["z", "i"], "-", 
                  SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["x", "i"], "-", 
             SubscriptBox["x", "j"]}], ")"}]}], 
          RowBox[{"q", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["y", "i"], "-", 
                 SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["z", "i"], "-", 
                 SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]}]], "-", 
         FractionBox[
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"q", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["y", "i"], "-", 
                  SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["z", "i"], "-", 
                  SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["x", "i"], "-", 
             SubscriptBox["x", "j"]}], ")"}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["x", "i"], "-", 
              SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["y", "i"], "-", 
              SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["z", "i"], "-", 
              SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "i"], "-", 
           SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["y", "i"], "-", 
           SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["z", "i"], "-", 
           SubscriptBox["z", "j"]}], ")"}], "2"]}]], ")"}]}], "+", 
    FractionBox[
     RowBox[{"q", " ", 
      SubscriptBox["f", "k"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"Sin", "[", 
           RowBox[{"q", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["y", "i"], "-", 
                 SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["z", "i"], "-", 
                 SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["x", "i"], "-", 
                SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["y", "i"], "-", 
                SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["z", "i"], "-", 
                SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
        FractionBox[
         RowBox[{"Cos", "[", 
          RowBox[{"q", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["x", "i"], "-", 
                SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["y", "i"], "-", 
                SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["z", "i"], "-", 
                SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
         RowBox[{"q", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "i"], "-", 
               SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["z", "i"], "-", 
               SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}]}], 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["x", "i"], "-", 
          SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["y", "i"], "-", 
          SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["z", "i"], "-", 
          SubscriptBox["z", "j"]}], ")"}], "2"]}]]]}], "}"}], "}"}]], "Output",\

 CellChangeTimes->{3.9005321146836643`*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"56d1bc37-e36b-41c9-99cf-68dbd1e4a6db"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 TemplateBox[{
   TemplateBox[{
     RowBox[{"(", 
       RowBox[{"F", "[", "q", "]"}], ")"}], 
     RowBox[{"{", 
       SubscriptBox["x", "j"], "}"}]}, "Grad"], 
   RowBox[{"{", 
     SubscriptBox["x", "i"], "}"}]},
  "Grad"]], "Input",
 CellChangeTimes->{3.9005321253152323`*^9},
 CellLabel->"In[17]:=",ExpressionUUID->"70cdeb90-52a0-47f2-bebb-53b54cd930ee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    FractionBox[
     RowBox[{"q", " ", 
      SubscriptBox["f", "k"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["x", "i"], "-", 
         SubscriptBox["x", "j"]}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"Sin", "[", 
           RowBox[{"q", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["y", "i"], "-", 
                 SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["z", "i"], "-", 
                 SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["x", "i"], "-", 
                SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["y", "i"], "-", 
                SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["z", "i"], "-", 
                SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
        FractionBox[
         RowBox[{"Cos", "[", 
          RowBox[{"q", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["x", "i"], "-", 
                SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["y", "i"], "-", 
                SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["z", "i"], "-", 
                SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
         RowBox[{"q", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "i"], "-", 
               SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["z", "i"], "-", 
               SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "i"], "-", 
           SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["y", "i"], "-", 
           SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["z", "i"], "-", 
           SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
      RowBox[{"3", "/", "2"}]]], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q", " ", 
       SubscriptBox["f", "k"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["x", "i"], "-", 
         SubscriptBox["x", "j"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"q", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["y", "i"], "-", 
                  SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["z", "i"], "-", 
                  SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["x", "i"], "-", 
             SubscriptBox["x", "j"]}], ")"}]}], 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["y", "i"], "-", 
                 SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["z", "i"], "-", 
                 SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], "2"]}]], "-", 
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"q", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["y", "i"], "-", 
                  SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["z", "i"], "-", 
                  SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["x", "i"], "-", 
             SubscriptBox["x", "j"]}], ")"}]}], 
          RowBox[{"q", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["y", "i"], "-", 
                 SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["z", "i"], "-", 
                 SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]}]], "-", 
         FractionBox[
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"q", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["y", "i"], "-", 
                  SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["z", "i"], "-", 
                  SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["x", "i"], "-", 
             SubscriptBox["x", "j"]}], ")"}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["x", "i"], "-", 
              SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["y", "i"], "-", 
              SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["z", "i"], "-", 
              SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "i"], "-", 
           SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["y", "i"], "-", 
           SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["z", "i"], "-", 
           SubscriptBox["z", "j"]}], ")"}], "2"]}]], ")"}]}], "-", 
    FractionBox[
     RowBox[{"q", " ", 
      SubscriptBox["f", "k"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"Sin", "[", 
           RowBox[{"q", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["y", "i"], "-", 
                 SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["z", "i"], "-", 
                 SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["x", "i"], "-", 
                SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["y", "i"], "-", 
                SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["z", "i"], "-", 
                SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
        FractionBox[
         RowBox[{"Cos", "[", 
          RowBox[{"q", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["x", "i"], "-", 
                SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["y", "i"], "-", 
                SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["z", "i"], "-", 
                SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
         RowBox[{"q", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "i"], "-", 
               SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["z", "i"], "-", 
               SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}]}], 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["x", "i"], "-", 
          SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["y", "i"], "-", 
          SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["z", "i"], "-", 
          SubscriptBox["z", "j"]}], ")"}], "2"]}]]]}], "}"}], "}"}]], "Output",\

 CellChangeTimes->{3.900532125889271*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"c28cee84-3352-4c99-802a-054906990c59"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"n", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mat", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           RowBox[{"(", 
             RowBox[{"F", "[", "q", "]"}], ")"}], 
           RowBox[{"{", 
             SubscriptBox["x", "j"], "}"}]}, "Grad"], 
         RowBox[{"{", 
           SubscriptBox["x", "i"], "}"}]},
        "Grad"], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"mat", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        TemplateBox[{
          TemplateBox[{
            RowBox[{"(", 
              RowBox[{"F", "[", "q", "]"}], ")"}], 
            RowBox[{"{", 
              SubscriptBox["x", "i"], "}"}]}, "Grad"], 
          RowBox[{"{", 
            SubscriptBox["x", "i"], "}"}]},
         "Grad"], ",", 
        TemplateBox[{
          TemplateBox[{
            RowBox[{"(", 
              RowBox[{"F", "[", "q", "]"}], ")"}], 
            RowBox[{"{", 
              SubscriptBox["x", "j"], "}"}]}, "Grad"], 
          RowBox[{"{", 
            SubscriptBox["x", "i"], "}"}]},
         "Grad"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        TemplateBox[{
          TemplateBox[{
            RowBox[{"(", 
              RowBox[{"F", "[", "q", "]"}], ")"}], 
            RowBox[{"{", 
              SubscriptBox["x", "i"], "}"}]}, "Grad"], 
          RowBox[{"{", 
            SubscriptBox["x", "j"], "}"}]},
         "Grad"], ",", 
        TemplateBox[{
          TemplateBox[{
            RowBox[{"(", 
              RowBox[{"F", "[", "q", "]"}], ")"}], 
            RowBox[{"{", 
              SubscriptBox["x", "j"], "}"}]}, "Grad"], 
          RowBox[{"{", 
            SubscriptBox["x", "j"], "}"}]},
         "Grad"]}], "}"}]}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.900532306847103*^9, 3.9005323557574778`*^9}, {
  3.900532398617605*^9, 3.900532437882164*^9}, {3.90053276679747*^9, 
  3.900532768774252*^9}, {3.900532884532123*^9, 3.9005330009044228`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"2abd81ab-3cc1-4fc3-a200-c000f6b93a56"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"q", " ", 
           SubscriptBox["f", "k"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["x", "i"], "-", 
              SubscriptBox["x", "j"]}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"Sin", "[", 
                RowBox[{"q", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
               RowBox[{
                SuperscriptBox["q", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
             
             FractionBox[
              RowBox[{"Cos", "[", 
               RowBox[{"q", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
              RowBox[{"q", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["x", "i"], "-", 
                SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["y", "i"], "-", 
                SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["z", "i"], "-", 
                SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"q", " ", 
           SubscriptBox["f", "k"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["x", "i"], "-", 
             SubscriptBox["x", "j"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"q", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}]}], 
              RowBox[{
               SuperscriptBox["q", "2"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], "2"]}]], 
             "-", 
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"q", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}]}], 
              RowBox[{"q", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
                RowBox[{"3", "/", "2"}]]}]], "-", 
             FractionBox[
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"q", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}]}], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["y", "i"], "-", 
                  SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["z", "i"], "-", 
                  SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], ")"}]}], ")"}], 
         "/", 
         RowBox[{"(", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "i"], "-", 
               SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["z", "i"], "-", 
               SubscriptBox["z", "j"]}], ")"}], "2"]}]], ")"}]}], "+", 
        FractionBox[
         RowBox[{"q", " ", 
          SubscriptBox["f", "k"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{"Sin", "[", 
               RowBox[{"q", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
              RowBox[{
               SuperscriptBox["q", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
            
            FractionBox[
             RowBox[{"Cos", "[", 
              RowBox[{"q", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
             RowBox[{"q", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}]}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["x", "i"], "-", 
              SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["y", "i"], "-", 
              SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["z", "i"], "-", 
              SubscriptBox["z", "j"]}], ")"}], "2"]}]]]}], "}"}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"q", " ", 
          SubscriptBox["f", "k"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["x", "i"], "-", 
             SubscriptBox["x", "j"]}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{"Sin", "[", 
               RowBox[{"q", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
              RowBox[{
               SuperscriptBox["q", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
            
            FractionBox[
             RowBox[{"Cos", "[", 
              RowBox[{"q", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
             RowBox[{"q", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "i"], "-", 
               SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["z", "i"], "-", 
               SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
          RowBox[{"3", "/", "2"}]]], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"q", " ", 
           SubscriptBox["f", "k"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["x", "i"], "-", 
             SubscriptBox["x", "j"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"q", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}]}], 
              RowBox[{
               SuperscriptBox["q", "2"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], "2"]}]], 
             "-", 
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"q", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}]}], 
              RowBox[{"q", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
                RowBox[{"3", "/", "2"}]]}]], "-", 
             FractionBox[
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"q", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}]}], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["y", "i"], "-", 
                  SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["z", "i"], "-", 
                  SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], ")"}]}], ")"}], 
         "/", 
         RowBox[{"(", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "i"], "-", 
               SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["z", "i"], "-", 
               SubscriptBox["z", "j"]}], ")"}], "2"]}]], ")"}]}], "-", 
        FractionBox[
         RowBox[{"q", " ", 
          SubscriptBox["f", "k"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{"Sin", "[", 
               RowBox[{"q", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
              RowBox[{
               SuperscriptBox["q", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
            
            FractionBox[
             RowBox[{"Cos", "[", 
              RowBox[{"q", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
             RowBox[{"q", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}]}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["x", "i"], "-", 
              SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["y", "i"], "-", 
              SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["z", "i"], "-", 
              SubscriptBox["z", "j"]}], ")"}], "2"]}]]]}], "}"}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"q", " ", 
          SubscriptBox["f", "k"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["x", "i"], "-", 
             SubscriptBox["x", "j"]}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{"Sin", "[", 
               RowBox[{"q", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
              RowBox[{
               SuperscriptBox["q", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
            
            FractionBox[
             RowBox[{"Cos", "[", 
              RowBox[{"q", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
             RowBox[{"q", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "i"], "-", 
               SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["z", "i"], "-", 
               SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
          RowBox[{"3", "/", "2"}]]], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"q", " ", 
           SubscriptBox["f", "k"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["x", "i"], "-", 
             SubscriptBox["x", "j"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"2", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"q", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}]}], 
               RowBox[{
                SuperscriptBox["q", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], "2"]}]]}],
              "+", 
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"q", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}]}], 
              RowBox[{"q", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
                RowBox[{"3", "/", "2"}]]}]], "+", 
             FractionBox[
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"q", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}]}], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["y", "i"], "-", 
                  SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["z", "i"], "-", 
                  SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], ")"}]}], ")"}], 
         "/", 
         RowBox[{"(", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "i"], "-", 
               SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["z", "i"], "-", 
               SubscriptBox["z", "j"]}], ")"}], "2"]}]], ")"}]}], "-", 
        FractionBox[
         RowBox[{"q", " ", 
          SubscriptBox["f", "k"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{"Sin", "[", 
               RowBox[{"q", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
              RowBox[{
               SuperscriptBox["q", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
            
            FractionBox[
             RowBox[{"Cos", "[", 
              RowBox[{"q", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
             RowBox[{"q", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}]}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["x", "i"], "-", 
              SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["y", "i"], "-", 
              SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["z", "i"], "-", 
              SubscriptBox["z", "j"]}], ")"}], "2"]}]]]}], "}"}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"q", " ", 
           SubscriptBox["f", "k"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["x", "i"], "-", 
              SubscriptBox["x", "j"]}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"Sin", "[", 
                RowBox[{"q", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
               RowBox[{
                SuperscriptBox["q", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
             
             FractionBox[
              RowBox[{"Cos", "[", 
               RowBox[{"q", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
              RowBox[{"q", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["x", "i"], "-", 
                SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["y", "i"], "-", 
                SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["z", "i"], "-", 
                SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"q", " ", 
           SubscriptBox["f", "k"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["x", "i"], "-", 
             SubscriptBox["x", "j"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"2", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"q", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}]}], 
               RowBox[{
                SuperscriptBox["q", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], "2"]}]]}],
              "+", 
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"q", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}]}], 
              RowBox[{"q", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
                RowBox[{"3", "/", "2"}]]}]], "+", 
             FractionBox[
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"q", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}]}], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["y", "i"], "-", 
                  SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["z", "i"], "-", 
                  SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], ")"}]}], ")"}], 
         "/", 
         RowBox[{"(", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "i"], "-", 
               SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["z", "i"], "-", 
               SubscriptBox["z", "j"]}], ")"}], "2"]}]], ")"}]}], "+", 
        FractionBox[
         RowBox[{"q", " ", 
          SubscriptBox["f", "k"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{"Sin", "[", 
               RowBox[{"q", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
              RowBox[{
               SuperscriptBox["q", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
            
            FractionBox[
             RowBox[{"Cos", "[", 
              RowBox[{"q", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
             RowBox[{"q", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}]}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["x", "i"], "-", 
              SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["y", "i"], "-", 
              SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["z", "i"], "-", 
              SubscriptBox["z", "j"]}], ")"}], "2"]}]]]}], "}"}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.900532332869124*^9, 3.9005323571456327`*^9}, {
   3.900532402628634*^9, 3.90053243928971*^9}, 3.900532769490651*^9, 
   3.9005329522847967`*^9, 3.900533001488545*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"8965a36f-6c70-4d68-b1c3-a38439fae374"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"eigVals", ",", "eigVecs"}], "}"}], "=", 
  RowBox[{"Eigensystem", "[", "mat", "]"}]}]], "Input",
 CellChangeTimes->{{3.9005325189667473`*^9, 3.900532525933158*^9}, {
  3.9005326940255527`*^9, 3.9005326943132677`*^9}, {3.900532754874221*^9, 
  3.900532755225382*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"32f5ad81-9c63-4065-b087-ff8ce831eeb6"],

Cell[BoxData[
 TemplateBox[{
  "Eigensystem", "matsq", 
   "\"Argument \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \
FractionBox[RowBox[{\\\"q\\\", \\\" \\\", SubscriptBox[\\\"f\\\", \\\"k\\\"], \
\\\" \\\", SuperscriptBox[RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"2\\\"], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"Times\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"4\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}]}], SuperscriptBox[RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
RowBox[{\\\"3\\\", \\\"/\\\", \\\"2\\\"}]]]}], \\\"+\\\", \
FractionBox[RowBox[{\\\"q\\\", \\\" \\\", SubscriptBox[\\\"f\\\", \\\"k\\\"], \
\\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"Subscript\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"Times\\\", \\\"[\
\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"5\\\", \\\"\[RightSkeleton]\\\"}], \
\\\"]\\\"}], \\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"5\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"4\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}], \
SqrtBox[RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]]], \\\"+\\\", \
FractionBox[RowBox[{\\\"q\\\", \\\" \\\", SubscriptBox[\\\"f\\\", \\\"k\\\"], \
\\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"Times\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"4\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}]}], SqrtBox[RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]]]}], \
\\\"}\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", \
RowBox[{FractionBox[RowBox[{\\\"q\\\", \\\" \\\", SubscriptBox[\\\"f\\\", \
\\\"k\\\"], \\\" \\\", SuperscriptBox[RowBox[{\\\"Plus\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"2\\\"], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"Times\\\
\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"4\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", RowBox[{\\\"Times\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}]}], \\\")\\\"}]}], SuperscriptBox[RowBox[{\\\"Plus\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], RowBox[{\\\"3\\\", \\\"/\\\", \\\"2\\\"}]]], \\\"-\\\", \
FractionBox[RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], SqrtBox[RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\
\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \
\\\"]\\\"}]]], \\\"-\\\", FractionBox[RowBox[{\\\"q\\\", \\\" \\\", \
SubscriptBox[\\\"f\\\", \\\"k\\\"], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\
\"4\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}], \
SqrtBox[RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]]]}], \\\"}\\\"}], \
\\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", \
RowBox[{FractionBox[RowBox[{\\\"q\\\", \\\" \\\", RowBox[{\\\"\[LeftSkeleton]\
\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\" \\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"4\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"+\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\
\"}]}], \\\")\\\"}]}], SuperscriptBox[RowBox[{\\\"Plus\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], RowBox[{\\\"3\\\", \\\"/\\\", \\\"2\\\"}]]], \\\"+\\\", \
FractionBox[RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], SqrtBox[RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}]]], \\\"-\\\", FractionBox[RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \
SqrtBox[RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}]]]}], \\\"}\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\
\\\"{\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}], \
\\\"}\\\"}]\\) at position \\!\\(\\*RowBox[{\\\"1\\\"}]\\) is not a non-empty \
square matrix.\"", 2, 47, 15, 24053237325356489418, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.9005325265119753`*^9, {3.900532694856598*^9, 3.900532697375956*^9}, {
   3.900532755942272*^9, 3.900532783831908*^9}, 3.90053296853963*^9, 
   3.9005330062298183`*^9},
 CellLabel->
  "During evaluation of \
In[47]:=",ExpressionUUID->"4139f8a3-2d13-41fc-bacf-9b323b59425e"],

Cell[BoxData[
 TemplateBox[{
  "Set", "shape", 
   "\"Lists \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"eigVals\\\", \\\",\\\", \
\\\"eigVecs\\\"}], \\\"}\\\"}]\\) and \\!\\(\\*RowBox[{\\\"Eigensystem\\\", \
\\\"[\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{RowBox[{\\\"-\\\
\", \\\"q\\\"}], \\\" \\\", RowBox[{\\\"Subscript\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\" \\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \
\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\
\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Power\\\
\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"q\\\", \\\" \
\\\", RowBox[{\\\"Subscript\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", \
RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Plus\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\"+\\\", RowBox[{\\\"q\\\", \\\" \\\", RowBox[{\\\"Subscript\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\" \\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \
\\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}]}], \\\"}\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"q\\\", \\\" \\\", RowBox[{\\\"Subscript\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\" \\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \
\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\
\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Power\\\
\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"-\\\", RowBox[{\\\"q\\\", \\\" \
\\\", RowBox[{\\\"Subscript\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", \
RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Plus\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\"-\\\", RowBox[{\\\"q\\\", \\\" \\\", RowBox[{\\\"Subscript\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\" \\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \
\\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}]}], \\\"}\\\"}], \
\\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\
\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]\\) are not the \
same shape.\"", 2, 47, 16, 24053237325356489418, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.9005325265119753`*^9, {3.900532694856598*^9, 3.900532697375956*^9}, {
   3.900532755942272*^9, 3.900532783831908*^9}, 3.90053296853963*^9, 
   3.900533006235949*^9},
 CellLabel->
  "During evaluation of \
In[47]:=",ExpressionUUID->"18667b39-4890-4c22-9dbf-ab75168e23d8"],

Cell[BoxData[
 RowBox[{"Eigensystem", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"q", " ", 
            SubscriptBox["f", "k"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"Sin", "[", 
                 RowBox[{"q", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
                RowBox[{
                 SuperscriptBox["q", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
              
              FractionBox[
               RowBox[{"Cos", "[", 
                RowBox[{"q", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
               RowBox[{"q", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["y", "i"], "-", 
                 SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["z", "i"], "-", 
                 SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"q", " ", 
            SubscriptBox["f", "k"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["x", "i"], "-", 
              SubscriptBox["x", "j"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               RowBox[{"2", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"q", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}]}], 
               RowBox[{
                SuperscriptBox["q", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], "2"]}]], 
              "-", 
              FractionBox[
               RowBox[{"2", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"q", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}]}], 
               RowBox[{"q", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
                 RowBox[{"3", "/", "2"}]]}]], "-", 
              FractionBox[
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"q", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}]}], 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], ")"}]}], ")"}],
           "/", 
          RowBox[{"(", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["x", "i"], "-", 
                SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["y", "i"], "-", 
                SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["z", "i"], "-", 
                SubscriptBox["z", "j"]}], ")"}], "2"]}]], ")"}]}], "+", 
         FractionBox[
          RowBox[{"q", " ", 
           SubscriptBox["f", "k"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"Sin", "[", 
                RowBox[{"q", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
               RowBox[{
                SuperscriptBox["q", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
             
             FractionBox[
              RowBox[{"Cos", "[", 
               RowBox[{"q", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
              RowBox[{"q", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}]}], 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "i"], "-", 
               SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["z", "i"], "-", 
               SubscriptBox["z", "j"]}], ")"}], "2"]}]]]}], "}"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"q", " ", 
           SubscriptBox["f", "k"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["x", "i"], "-", 
              SubscriptBox["x", "j"]}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"Sin", "[", 
                RowBox[{"q", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
               RowBox[{
                SuperscriptBox["q", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
             
             FractionBox[
              RowBox[{"Cos", "[", 
               RowBox[{"q", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
              RowBox[{"q", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["x", "i"], "-", 
                SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["y", "i"], "-", 
                SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["z", "i"], "-", 
                SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"q", " ", 
            SubscriptBox["f", "k"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["x", "i"], "-", 
              SubscriptBox["x", "j"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               RowBox[{"2", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"q", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}]}], 
               RowBox[{
                SuperscriptBox["q", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], "2"]}]], 
              "-", 
              FractionBox[
               RowBox[{"2", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"q", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}]}], 
               RowBox[{"q", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
                 RowBox[{"3", "/", "2"}]]}]], "-", 
              FractionBox[
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"q", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}]}], 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], ")"}]}], ")"}],
           "/", 
          RowBox[{"(", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["x", "i"], "-", 
                SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["y", "i"], "-", 
                SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["z", "i"], "-", 
                SubscriptBox["z", "j"]}], ")"}], "2"]}]], ")"}]}], "-", 
         FractionBox[
          RowBox[{"q", " ", 
           SubscriptBox["f", "k"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"Sin", "[", 
                RowBox[{"q", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
               RowBox[{
                SuperscriptBox["q", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
             
             FractionBox[
              RowBox[{"Cos", "[", 
               RowBox[{"q", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
              RowBox[{"q", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}]}], 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "i"], "-", 
               SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["z", "i"], "-", 
               SubscriptBox["z", "j"]}], ")"}], "2"]}]]]}], "}"}], "}"}]}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"q", " ", 
           SubscriptBox["f", "k"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["x", "i"], "-", 
              SubscriptBox["x", "j"]}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"Sin", "[", 
                RowBox[{"q", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
               RowBox[{
                SuperscriptBox["q", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
             
             FractionBox[
              RowBox[{"Cos", "[", 
               RowBox[{"q", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
              RowBox[{"q", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["x", "i"], "-", 
                SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["y", "i"], "-", 
                SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["z", "i"], "-", 
                SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"q", " ", 
            SubscriptBox["f", "k"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["x", "i"], "-", 
              SubscriptBox["x", "j"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"2", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"q", " ", 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}]}], 
                RowBox[{
                 SuperscriptBox["q", "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], "2"]}]]}],
               "+", 
              FractionBox[
               RowBox[{"2", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"q", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}]}], 
               RowBox[{"q", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
                 RowBox[{"3", "/", "2"}]]}]], "+", 
              FractionBox[
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"q", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}]}], 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], ")"}]}], ")"}],
           "/", 
          RowBox[{"(", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["x", "i"], "-", 
                SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["y", "i"], "-", 
                SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["z", "i"], "-", 
                SubscriptBox["z", "j"]}], ")"}], "2"]}]], ")"}]}], "-", 
         FractionBox[
          RowBox[{"q", " ", 
           SubscriptBox["f", "k"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"Sin", "[", 
                RowBox[{"q", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
               RowBox[{
                SuperscriptBox["q", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
             
             FractionBox[
              RowBox[{"Cos", "[", 
               RowBox[{"q", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
              RowBox[{"q", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}]}], 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "i"], "-", 
               SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["z", "i"], "-", 
               SubscriptBox["z", "j"]}], ")"}], "2"]}]]]}], "}"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"q", " ", 
            SubscriptBox["f", "k"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"Sin", "[", 
                 RowBox[{"q", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
                RowBox[{
                 SuperscriptBox["q", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
              
              FractionBox[
               RowBox[{"Cos", "[", 
                RowBox[{"q", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
               RowBox[{"q", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "i"], "-", 
                 SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["y", "i"], "-", 
                 SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["z", "i"], "-", 
                 SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"q", " ", 
            SubscriptBox["f", "k"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["x", "i"], "-", 
              SubscriptBox["x", "j"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"2", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"q", " ", 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}]}], 
                RowBox[{
                 SuperscriptBox["q", "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], "2"]}]]}],
               "+", 
              FractionBox[
               RowBox[{"2", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"q", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}]}], 
               RowBox[{"q", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}], 
                 RowBox[{"3", "/", "2"}]]}]], "+", 
              FractionBox[
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"q", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["x", "i"], "-", 
                  SubscriptBox["x", "j"]}], ")"}]}], 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["x", "i"], "-", 
                   SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["y", "i"], "-", 
                   SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["z", "i"], "-", 
                   SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], ")"}]}], ")"}],
           "/", 
          RowBox[{"(", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["x", "i"], "-", 
                SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["y", "i"], "-", 
                SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["z", "i"], "-", 
                SubscriptBox["z", "j"]}], ")"}], "2"]}]], ")"}]}], "+", 
         FractionBox[
          RowBox[{"q", " ", 
           SubscriptBox["f", "k"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"Sin", "[", 
                RowBox[{"q", " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
               RowBox[{
                SuperscriptBox["q", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}], ")"}]}]]}], "+", 
             
             FractionBox[
              RowBox[{"Cos", "[", 
               RowBox[{"q", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}], "]"}], 
              RowBox[{"q", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["x", "i"], "-", 
                    SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["y", "i"], "-", 
                    SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["z", "i"], "-", 
                    SubscriptBox["z", "j"]}], ")"}], "2"]}]]}]]}], ")"}]}], 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["x", "i"], "-", 
               SubscriptBox["x", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["y", "i"], "-", 
               SubscriptBox["y", "j"]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["z", "i"], "-", 
               SubscriptBox["z", "j"]}], ")"}], "2"]}]]]}], "}"}], "}"}]}], 
     "}"}]}], "}"}], "]"}]], "Output",
 CellChangeTimes->{
  3.900532526917781*^9, {3.9005326948752604`*^9, 3.900532697394342*^9}, {
   3.900532755959145*^9, 3.900532783856618*^9}, 3.900532968549987*^9, 
   3.900533006244425*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"a0691172-e0a0-41c8-939a-75a4d121f8af"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.900532558513341*^9, 
  3.9005325592014236`*^9}},ExpressionUUID->"9a1f61cc-a684-43c1-aa5a-\
9a887ad03403"]
},
WindowSize->{846, 275.25},
WindowMargins->{{0, Automatic}, {275.25, 13.5}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.3 for Linux x86 (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"0ff82d7b-c191-4c66-9904-89f017f0f17c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1480, 40, 52, "Input",ExpressionUUID->"10bd1a91-960a-40a6-9d1f-f74699196983"],
Cell[2063, 64, 1155, 32, 76, "Output",ExpressionUUID->"7ebd41dd-def4-4a42-ac62-3352b74b7db2"]
}, Open  ]],
Cell[3233, 99, 395, 6, 29, "Input",ExpressionUUID->"a9fcef6d-53b6-48f4-a0c6-58bf5bdb85eb"],
Cell[3631, 107, 211, 5, 29, "Input",ExpressionUUID->"e667996f-aaea-4a41-b234-bc23bdb4ff43"],
Cell[3845, 114, 152, 3, 29, "Input",ExpressionUUID->"cad1be5d-7595-4a89-b0ae-3529288684fb"],
Cell[CellGroupData[{
Cell[4022, 121, 479, 10, 31, "Input",ExpressionUUID->"30422168-0832-498a-a1ca-fe9233db02cb"],
Cell[4504, 133, 4775, 144, 197, "Output",ExpressionUUID->"9859968c-cbe8-4e02-aa37-4ac111b4ee2a"]
}, Open  ]],
Cell[9294, 280, 203, 4, 29, "Input",ExpressionUUID->"b3958018-5d9c-4e82-9b8f-8e94f7b87bf6"],
Cell[CellGroupData[{
Cell[9522, 288, 866, 26, 31, "Input",ExpressionUUID->"ed25bad1-e509-4011-b788-098495d935c0"],
Cell[10391, 316, 771, 21, 60, "Output",ExpressionUUID->"30868f64-c526-4ffb-8c37-00b9ec6966c3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11199, 342, 785, 17, 31, "Input",ExpressionUUID->"2b2c4d15-3013-42be-9f95-1874cf63dbb6"],
Cell[11987, 361, 20097, 552, 721, "Output",ExpressionUUID->"e06141b4-1d19-4a6a-9391-7061a7ee98be"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32121, 918, 396, 11, 34, "Input",ExpressionUUID->"d85fbf89-104c-4dd0-8828-81c2aee0a145"],
Cell[32520, 931, 20143, 553, 721, "Output",ExpressionUUID->"73d54b19-f9f7-4119-822e-22aecbdf4f25"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52700, 1489, 387, 10, 50, "Input",ExpressionUUID->"bae667fa-1b80-4767-a411-556b92e3d09f"],
Cell[53090, 1501, 804, 25, 40, "Output",ExpressionUUID->"9355dbc0-08f6-41f2-b513-50b4a91eb0d3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53931, 1531, 309, 8, 31, "Input",ExpressionUUID->"7d163013-522e-47ed-99e4-22a7066e7f79"],
Cell[54243, 1541, 3436, 107, 78, "Output",ExpressionUUID->"1876a1e0-f81f-4c4b-882d-94723fb2a68d"]
}, Open  ]],
Cell[57694, 1651, 152, 3, 29, "Input",ExpressionUUID->"554c50a0-51da-4790-a3b8-13fbce05101f"],
Cell[CellGroupData[{
Cell[57871, 1658, 397, 11, 31, "Input",ExpressionUUID->"395ac65b-371e-45be-a70b-e48def08f163"],
Cell[58271, 1671, 12833, 373, 310, "Output",ExpressionUUID->"56d1bc37-e36b-41c9-99cf-68dbd1e4a6db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71141, 2049, 375, 11, 34, "Input",ExpressionUUID->"70cdeb90-52a0-47f2-bebb-53b54cd930ee"],
Cell[71519, 2062, 12704, 372, 310, "Output",ExpressionUUID->"c28cee84-3352-4c99-802a-054906990c59"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84260, 2439, 2330, 68, 99, "Input",ExpressionUUID->"2abd81ab-3cc1-4fc3-a200-c000f6b93a56"],
Cell[86593, 2509, 56829, 1510, 1228, "Output",ExpressionUUID->"8965a36f-6c70-4d68-b1c3-a38439fae374"]
}, Open  ]],
Cell[CellGroupData[{
Cell[143459, 4024, 397, 8, 29, "Input",ExpressionUUID->"32f5ad81-9c63-4065-b087-ff8ce831eeb6"],
Cell[143859, 4034, 5870, 85, 206, "Message",ExpressionUUID->"4139f8a3-2d13-41fc-bacf-9b323b59425e"],
Cell[149732, 4121, 4123, 60, 99, "Message",ExpressionUUID->"18667b39-4890-4c22-9dbf-ab75168e23d8"],
Cell[153858, 4183, 57934, 1510, 1250, "Output",ExpressionUUID->"a0691172-e0a0-41c8-939a-75a4d121f8af"]
}, Open  ]],
Cell[211807, 5696, 154, 3, 29, "Input",ExpressionUUID->"9a1f61cc-a684-43c1-aa5a-9a887ad03403"]
}
]
*)

